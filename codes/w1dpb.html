<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Arman Akbarian's Homepage" />
<meta name="keywords" content="Arman Akbarian homepage web webpage academic website site UBC
numerical relativity group" />
<meta name="author" content="Arman Akbarian" />
<link rel="stylesheet" type="text/css" href="pagestyle.css" />
<title>Arman Akbarian's Homepage</title>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>
<div class="page">
  <div class="page2">
     <div style="width:100%;height:1px;font-family: Tahoma; font-size: 1pt;"></div>
     <div  class ="header">
		
	     <div class="title">

			Arman Akbarian
			<div class="subtitle">UNIVERSITY OF BRITISH COLUMBIA <br /> PHYSICS &amp; ASTRONOMY DEPT. </div>
	</div> <!-- End of title -->
		<div class="sidebar">
         	<div class="sider">
               <p><a href="Home.html">Home <img src="img/home.svg" width="11px" /></a>
<a href="Research.html">Research <img src="img/beaker.svg" width="11px" /></a>
<a href="Publications.html">Publications <img src="img/pencil.svg" width="11px" /></a>
<a target="_blank" href="http://laplace.phas.ubc.ca/">Group Page <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/people.svg" width="11px" /></a>
<a href="Contact.html">Contact <img src="img/envelope-closed.svg" width="11px" /></a>
<a href="CV.html">CV <img src="img/person.svg" width="11px" /></a></p>

<hr />

<p><a href="Links.html">Links <img src="img/link.svg" width="11px" /></a>
<a href="Learn-By-Examples.html">Programming <img src="img/code.svg" width="11px"/></a>
<a target="_blank" href="FD_doc">FD Toolkit <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/graph.svg" width="11px" /></a>
<a target="_blank" href="sg">Web Template <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/globe.svg" width="11px" /></a>
<a href="http://rmanak.github.io/notes">Miscellany <img src="img/layers.svg" width="11px" /></a></p>

             </div>
         </div> <!--End of Sidebar -->


     </div> <!-- end header -->
	
     <!--This line is for future use -->   <div style="text-align:center; padding-top:10px; padding-bottom:10px;"></div>
	      
     <!--This line is for compatibility issues --> <div style="width:100%;height:5px;font-family: Tahoma; font-size: 1pt;"></div>
     <!--in class page2 -->
     <div class="postandside">
		        <div class="content">
            <div class="post">
              <p><style type="text/css">
.Comment { color: #8080ff; }
.Constant { color: #ff6060; }
.Special { color: #ff40ff; }
.Statement { color: #88AA00; }
</style></p>

<pre>
<span class="Comment">#-------------------------------------------</span>
<span class="Comment"># AAK:</span>
<span class="Comment"># Sun Mar  9 23:04:06 PDT 2014</span>
<span class="Comment"># Example of solving 1D wave equaiton using FD</span>
<span class="Comment"># and implementing O(h^2) Cranck-Nickelson</span>
<span class="Comment"># implicit finite differencing and periodic</span>
<span class="Comment"># boundary condition</span>
<span class="Comment">#----------------------------------------------</span>
<span class="Statement">read</span> <span class="Constant">&quot;/d/bh8/home/arman/FD/FD.mpl&quot;</span><span class="Special">:</span>

Clean_FD<span class="Special">()</span><span class="Special">;</span>
Make_FD<span class="Special">()</span><span class="Special">;</span>

grid_functions <span class="Special">:=</span> <span class="Special">{</span>f<span class="Special">,</span>f_t<span class="Special">}</span><span class="Special">;</span>

eq1 <span class="Special">:=</span> <span class="Statement">diff</span><span class="Special">(</span>f<span class="Special">(</span>t<span class="Special">,</span>x<span class="Special">)</span><span class="Special">,</span>t<span class="Special">)</span> <span class="Statement">=</span> f_t<span class="Special">(</span>t<span class="Special">,</span>x<span class="Special">)</span><span class="Special">;</span>
eq2 <span class="Special">:=</span> <span class="Statement">diff</span><span class="Special">(</span>f_t<span class="Special">(</span>t<span class="Special">,</span>x<span class="Special">)</span><span class="Special">,</span>t<span class="Special">)</span> <span class="Statement">=</span> <span class="Statement">diff</span><span class="Special">(</span>f<span class="Special">(</span>t<span class="Special">,</span>x<span class="Special">)</span><span class="Special">,</span>x<span class="Special">,</span>x<span class="Special">)</span><span class="Special">;</span>

<span class="Comment">#Equivalent to second order PDE (wave equation)</span>
eq3 <span class="Special">:=</span> <span class="Statement">diff</span><span class="Special">(</span>f<span class="Special">(</span>t<span class="Special">,</span>x<span class="Special">)</span><span class="Special">,</span>t<span class="Special">,</span>t<span class="Special">)</span> <span class="Statement">=</span> <span class="Statement">diff</span><span class="Special">(</span>f<span class="Special">(</span>t<span class="Special">,</span>x<span class="Special">)</span><span class="Special">,</span>x<span class="Special">,</span>x<span class="Special">)</span><span class="Special">;</span>

<span class="Comment">#Independent Residual Evaluators (default: o(h^2) centered)</span>
Gen_Res_Code<span class="Special">(</span><span class="Statement">lhs</span><span class="Special">(</span>eq3<span class="Special">)</span>-<span class="Statement">rhs</span><span class="Special">(</span>eq3<span class="Special">)</span><span class="Special">,</span>input<span class="Statement">=</span><span class="Constant">&quot;c&quot;</span><span class="Special">,</span>proc_name<span class="Statement">=</span><span class="Constant">&quot;ire_f&quot;</span><span class="Special">)</span><span class="Special">;</span>

<span class="Comment">#Applying (default) second order finite differencing on </span>
<span class="Comment">#spacial derivatives in the equations:</span>
eq1_R_D <span class="Special">:=</span> Gen_Sten<span class="Special">(</span><span class="Statement">rhs</span><span class="Special">(</span>eq1<span class="Special">))</span><span class="Special">;</span>
eq2_R_D <span class="Special">:=</span> Gen_Sten<span class="Special">(</span><span class="Statement">rhs</span><span class="Special">(</span>eq2<span class="Special">))</span><span class="Special">;</span>

<span class="Comment"># Changing FD scheme to first order forward in time used</span>
<span class="Comment"># in CN scheme:</span>
FD_table<span class="Special">[</span>t<span class="Special">]</span> <span class="Special">:=</span> <span class="Special">[[</span><span class="Constant">0</span><span class="Special">]</span><span class="Special">,</span><span class="Special">[</span><span class="Constant">0</span><span class="Special">,</span><span class="Constant">1</span><span class="Special">]]</span><span class="Special">;</span>
eq1_L_D<span class="Special">:=</span>Gen_Sten<span class="Special">(</span><span class="Statement">lhs</span><span class="Special">(</span>eq1<span class="Special">))</span><span class="Special">;</span>
eq2_L_D<span class="Special">:=</span>Gen_Sten<span class="Special">(</span><span class="Statement">lhs</span><span class="Special">(</span>eq2<span class="Special">))</span><span class="Special">;</span>

<span class="Comment"># Creating averaging FD operator to create the second order</span>
<span class="Comment"># scheme:</span>
AVGT <span class="Special">:=</span> a -<span class="Statement">&gt;</span> <span class="Special">(</span>   FD<span class="Special">(</span> a<span class="Special">,</span><span class="Special">[</span> <span class="Special">[</span><span class="Constant">1</span><span class="Special">]</span><span class="Special">,</span><span class="Special">[</span><span class="Constant">0</span><span class="Special">]</span> <span class="Special">])</span> + FD<span class="Special">(</span> a<span class="Special">,</span><span class="Special">[</span> <span class="Special">[</span><span class="Constant">0</span><span class="Special">]</span><span class="Special">,</span><span class="Special">[</span><span class="Constant">0</span><span class="Special">]</span> <span class="Special">])</span> <span class="Special">)</span>/<span class="Constant">2</span><span class="Special">;</span>

<span class="Comment">#FDA equivalent of PDE: (now second order Cranck-Nickelson)</span>
eq1_D<span class="Special">:=</span> eq1_L_D - AVGT<span class="Special">(</span>eq1_R_D<span class="Special">)</span><span class="Special">;</span>
eq2_D<span class="Special">:=</span> eq2_L_D - AVGT<span class="Special">(</span>eq2_R_D<span class="Special">)</span><span class="Special">;</span>

<span class="Comment">#Making the FDA periodic at left and right boundarie:</span>
eq1_D_lb<span class="Special">:=</span>FD_Periodic<span class="Special">(</span>eq1_D<span class="Special">,</span><span class="Special">{</span>i<span class="Statement">=</span><span class="Constant">1</span><span class="Special">})</span><span class="Special">;</span>
eq1_D_rb<span class="Special">:=</span>FD_Periodic<span class="Special">(</span>eq1_D<span class="Special">,</span><span class="Special">{</span>i<span class="Statement">=</span>Nx<span class="Special">})</span><span class="Special">;</span>
eq2_D_lb<span class="Special">:=</span>FD_Periodic<span class="Special">(</span>eq2_D<span class="Special">,</span><span class="Special">{</span>i<span class="Statement">=</span><span class="Constant">1</span><span class="Special">})</span><span class="Special">;</span>
eq2_D_rb<span class="Special">:=</span>FD_Periodic<span class="Special">(</span>eq2_D<span class="Special">,</span><span class="Special">{</span>i<span class="Statement">=</span>Nx<span class="Special">})</span><span class="Special">;</span>

<span class="Comment">#Initialization profiles:</span>
init_f<span class="Special">:=</span>A*<span class="Statement">exp</span><span class="Special">(</span>-<span class="Special">(</span>x-x0<span class="Special">)</span>^<span class="Constant">2</span>/delx^<span class="Constant">2</span><span class="Special">)</span><span class="Special">;</span>
init_f_t<span class="Special">:=</span>idsignum*<span class="Statement">diff</span><span class="Special">(</span>init_f<span class="Special">,</span>x<span class="Special">)</span><span class="Special">;</span>

<span class="Comment">#Creating initializer subroutines:</span>
Gen_Eval_Code<span class="Special">(</span>init_f<span class="Special">,</span>input<span class="Statement">=</span><span class="Constant">&quot;c&quot;</span><span class="Special">,</span>proc_name<span class="Statement">=</span><span class="Constant">&quot;init_f&quot;</span><span class="Special">)</span><span class="Special">;</span>
Gen_Eval_Code<span class="Special">(</span>init_f_t<span class="Special">,</span>input<span class="Statement">=</span><span class="Constant">&quot;c&quot;</span><span class="Special">,</span>proc_name<span class="Statement">=</span><span class="Constant">&quot;init_f_t&quot;</span><span class="Special">)</span><span class="Special">;</span>

<span class="Comment"># FDA specifier for boundaries and interior points:</span>
s_f<span class="Special">:=</span> <span class="Special">[</span>
  <span class="Special">{</span> i<span class="Statement">=</span><span class="Special">[</span><span class="Constant">1</span><span class="Special">,</span><span class="Constant">1</span><span class="Special">,</span><span class="Constant">1</span><span class="Special">]</span>     <span class="Special">}</span> <span class="Statement">=</span> eq1_D_lb <span class="Special">,</span>
  <span class="Special">{</span> i<span class="Statement">=</span><span class="Special">[</span><span class="Constant">2</span><span class="Special">,</span>Nx<span class="Constant">-1</span><span class="Special">,</span><span class="Constant">1</span><span class="Special">]</span>  <span class="Special">}</span> <span class="Statement">=</span> eq1_D<span class="Special">,</span>
  <span class="Special">{</span> i<span class="Statement">=</span><span class="Special">[</span>Nx<span class="Special">,</span>Nx<span class="Special">,</span><span class="Constant">1</span><span class="Special">]</span>   <span class="Special">}</span> <span class="Statement">=</span> eq1_D_rb
<span class="Special">]</span><span class="Special">;</span>

s_f_t<span class="Special">:=</span> <span class="Special">[</span>
  <span class="Special">{</span> i<span class="Statement">=</span><span class="Special">[</span><span class="Constant">1</span><span class="Special">,</span><span class="Constant">1</span><span class="Special">,</span><span class="Constant">1</span><span class="Special">]</span>     <span class="Special">}</span> <span class="Statement">=</span> eq2_D_lb <span class="Special">,</span>
  <span class="Special">{</span> i<span class="Statement">=</span><span class="Special">[</span><span class="Constant">2</span><span class="Special">,</span>Nx<span class="Constant">-1</span><span class="Special">,</span><span class="Constant">1</span><span class="Special">]</span>  <span class="Special">}</span> <span class="Statement">=</span> eq2_D<span class="Special">,</span>
  <span class="Special">{</span> i<span class="Statement">=</span><span class="Special">[</span>Nx<span class="Special">,</span>Nx<span class="Special">,</span><span class="Constant">1</span><span class="Special">]</span>   <span class="Special">}</span> <span class="Statement">=</span> eq2_D_rb
<span class="Special">]</span><span class="Special">;</span>

<span class="Comment">#Residual evaluators code for time update:</span>
A_Gen_Res_Code<span class="Special">(</span>s_f<span class="Special">,</span>input<span class="Statement">=</span><span class="Constant">&quot;d&quot;</span><span class="Special">,</span>proc_name<span class="Statement">=</span><span class="Constant">&quot;res_f&quot;</span><span class="Special">,</span>is_periodic<span class="Statement">=</span><span class="Constant">true</span><span class="Special">)</span><span class="Special">;</span>
A_Gen_Res_Code<span class="Special">(</span>s_f_t<span class="Special">,</span>input<span class="Statement">=</span><span class="Constant">&quot;d&quot;</span><span class="Special">,</span>proc_name<span class="Statement">=</span><span class="Constant">&quot;res_f_t&quot;</span><span class="Special">,</span>is_periodic<span class="Statement">=</span><span class="Constant">true</span><span class="Special">)</span><span class="Special">;</span>

<span class="Comment">#1 Step Newton-Gauss-Sider solver code:</span>
A_Gen_Solve_Code<span class="Special">(</span>s_f<span class="Special">,</span><span class="Special">{</span>f<span class="Special">(</span>n<span class="Constant">+1</span><span class="Special">,</span>i<span class="Special">)}</span><span class="Special">,</span>input<span class="Statement">=</span><span class="Constant">&quot;d&quot;</span><span class="Special">,</span>proc_name<span class="Statement">=</span><span class="Constant">&quot;u_f&quot;</span><span class="Special">,</span>is_periodic<span class="Statement">=</span><span class="Constant">true</span><span class="Special">)</span><span class="Special">;</span>
A_Gen_Solve_Code<span class="Special">(</span>s_f_t<span class="Special">,</span><span class="Special">{</span>f_t<span class="Special">(</span>n<span class="Constant">+1</span><span class="Special">,</span>i<span class="Special">)}</span><span class="Special">,</span>input<span class="Statement">=</span><span class="Constant">&quot;d&quot;</span><span class="Special">,</span>proc_name<span class="Statement">=</span><span class="Constant">&quot;u_f_t&quot;</span><span class="Special">,</span>is_periodic<span class="Statement">=</span><span class="Constant">true</span><span class="Special">)</span><span class="Special">;</span>

<span class="Comment"># See main.c for a simple driver</span>
</pre>

<p>

</p>

		      <div style="clear: both;"></div>
	         </div>
		      <hr />
	         <div class ="date">last update: Wed Aug 19, 2015</div>
	    <div class="footer">
           <p><a href="Home.html">Home</a>|<a href="Research.html">Research</a>|<a href="Contact.html">Contact</a>|<a href="Links.html">Links</a>|<a href="Misc.html">Misc</a>|<a href="sg">Template</a></p>

      </div>  
	    <div style="clear: both;">&nbsp;</div>
        </div> <!-- end content -->
	<!-- in class postandside -->

                 <!--in class postandside-->   
         <!--this line is for compatibility issues --><div style="clear: both;">&#160;</div> <!--Displacement --> 
     </div> <!--End of post and side -->

     <!-- in class page2 -->
     <div style="clear: both;">&nbsp;</div>
  </div> <!--End of Page2 -->
     <div style="clear: both;">&nbsp;</div>

</div> <!-- End of page -->
<!--this is end of the file -->
<!-- ~~~ This content is generated using sg web template ~~-->
<!-- ~~~ For more information visit: http://laplace.physics.ubc.ca/People/arman/sg ~~ -->
</body>
</html>
