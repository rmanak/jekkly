<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Arman Akbarian's Homepage" />
<meta name="keywords" content="Arman Akbarian homepage web webpage academic website site UBC
numerical relativity group" />
<meta name="author" content="Arman Akbarian" />
<link rel="stylesheet" type="text/css" href="pagestyle.css" />
<title>Arman Akbarian's Homepage</title>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>
<div class="page">
  <div class="page2">
     <div style="width:100%;height:1px;font-family: Tahoma; font-size: 1pt;"></div>
     <div  class ="header">
		
	     <div class="title">

			Arman Akbarian
			<div class="subtitle">UNIVERSITY OF BRITISH COLUMBIA <br /> PHYSICS &amp; ASTRONOMY DEPT. </div>
	</div> <!-- End of title -->
		<div class="sidebar">
         	<div class="sider">
               <p><a href="Home.html">Home <img src="img/home.svg" width="11px" /></a>
<a href="Research.html">Research <img src="img/beaker.svg" width="11px" /></a>
<a href="Publications.html">Publications <img src="img/pencil.svg" width="11px" /></a>
<a target="_blank" href="http://laplace.phas.ubc.ca/">Group Page <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/people.svg" width="11px" /></a>
<a href="Contact.html">Contact <img src="img/envelope-closed.svg" width="11px" /></a>
<a href="CV.html">CV <img src="img/person.svg" width="11px" /></a></p>

<hr />

<p><a href="Links.html">Links <img src="img/link.svg" width="11px" /></a>
<a href="Learn-By-Examples.html">Programming <img src="img/code.svg" width="11px"/></a>
<a target="_blank" href="FD_doc">FD Toolkit <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/graph.svg" width="11px" /></a>
<a target="_blank" href="sg">Web Template <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/globe.svg" width="11px" /></a>
<a href="http://rmanak.github.io/notes">Miscellany <img src="img/layers.svg" width="11px" /></a></p>

             </div>
         </div> <!--End of Sidebar -->


     </div> <!-- end header -->
	
     <!--This line is for future use -->   <div style="text-align:center; padding-top:10px; padding-bottom:10px;"></div>
	      
     <!--This line is for compatibility issues --> <div style="width:100%;height:5px;font-family: Tahoma; font-size: 1pt;"></div>
     <!--in class page2 -->
     <div class="postandside">
		        <div class="content">
            <div class="post">
              <p><style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #000000; }
* { font-size: 1em; }
.Constant { color: #ff6060; }
.Special { color: #ff40ff; }
.Statement { color: #ffaa33; }
.PreProc { color: #ff40ff; }
.Type { color: #00ff00; }
-->
</style></p>

<script type='text/javascript'>
<!--

-->
</script>

<pre id='vimCodeElement'>
<span class="PreProc">#include </span><span class="Constant">&lt;bbhutil.h&gt;</span>
<span class="PreProc">#include </span><span class="Constant">&lt;dv.h&gt;</span>
<span class="PreProc">#include </span><span class="Constant">&lt;iv.h&gt;</span>
<span class="PreProc">#include </span><span class="Constant">&lt;string.h&gt;</span>

<span class="PreProc">#define max_fname_size </span><span class="Constant">256</span>
<span class="PreProc">#define max_name_size </span><span class="Constant">64</span>
<span class="PreProc">#define max_dim </span><span class="Constant">3</span>

<span class="Type">struct</span> my_SDF {
   <span class="Type">char</span> file[max_fname_size];
   <span class="Type">char</span> name[max_name_size];
   <span class="Type">char</span> **cnames;
   <span class="Type">int</span> dim;
   <span class="Type">int</span> size;
   <span class="Type">int</span> coord_size;
   <span class="Type">int</span> shape[max_dim];
   <span class="Type">double</span> bbox[max_dim*<span class="Constant">2</span>];
   <span class="Type">double</span> *data;
   <span class="Type">double</span> *coords;
   <span class="Type">double</span> *x;
   <span class="Type">double</span> *y;
   <span class="Type">double</span> *z;
   <span class="Type">double</span> dx;
   <span class="Type">double</span> dy;
   <span class="Type">double</span> dz;
   <span class="Type">int</span> Nx;
   <span class="Type">int</span> Ny;
   <span class="Type">int</span> Nz;
   <span class="Type">double</span> xmin;
   <span class="Type">double</span> xmax;
   <span class="Type">double</span> ymin;
   <span class="Type">double</span> ymax;
   <span class="Type">double</span> zmin;
   <span class="Type">double</span> zmax;
} ;

<span class="Type">typedef</span> <span class="Type">struct</span> my_SDF SDF;

<span class="Type">int</span> sdf_read(SDF *g, <span class="Type">const</span> <span class="Type">char</span> *fname, <span class="Type">int</span> lev, <span class="Type">double</span> *time);

<span class="Type">int</span> sdf_read(SDF *g, <span class="Type">const</span> <span class="Type">char</span> *fname, <span class="Type">int</span> lev, <span class="Type">double</span> *time) {
   <span class="Type">int</span> j;
   <span class="Type">int</span> coord_count;
   <span class="Type">int</span> rc;

   <span class="Statement">if</span> (lev &lt; <span class="Constant">0</span>) {
      <span class="Statement">if</span>(g-&gt;coords) free(g-&gt;coords);
      <span class="Statement">if</span>(g-&gt;data) free(g-&gt;data);
      <span class="Statement">if</span>(g-&gt;cnames[<span class="Constant">0</span>]) free(g-&gt;cnames[<span class="Constant">0</span>]);
      g-&gt;data=<span class="Constant">NULL</span>;
      g-&gt;coords=<span class="Constant">NULL</span>;
      g-&gt;cnames[<span class="Constant">0</span>]=<span class="Constant">NULL</span>;
      <span class="Statement">return</span>(<span class="Constant">1</span>);
   }
   strcpy(g-&gt;file,fname);

   rc = gft_read_rank(g-&gt;file,lev,&amp;(g-&gt;dim));

   ivls(g-&gt;shape,<span class="Constant">1</span>,max_dim);

   gft_read_shape(g-&gt;file,lev,g-&gt;shape);

   gft_read_name(g-&gt;file,<span class="Constant">1</span>,g-&gt;name);

   g-&gt;coord_size = <span class="Constant">0</span>;
   g-&gt;size = <span class="Constant">1</span>;

   <span class="Statement">for</span>(j=<span class="Constant">0</span>; j&lt; g-&gt;dim; j++) {
      g-&gt;coord_size += g-&gt;shape[j];
      g-&gt;size *= g-&gt;shape[j];
   }

   g-&gt;coords = vec_alloc(g-&gt;coord_size);
   g-&gt;data = vec_alloc(g-&gt;size);

   g-&gt;cnames = (<span class="Type">char</span> **)malloc(<span class="Constant">1</span>*<span class="Statement">sizeof</span>(<span class="Type">char</span> *));
   g-&gt;cnames[<span class="Constant">0</span>] = (<span class="Type">char</span> *)malloc(<span class="Constant">6</span>*<span class="Statement">sizeof</span>(<span class="Type">char</span>));

   gft_read_full(g-&gt;file,lev,g-&gt;shape,g-&gt;cnames[<span class="Constant">0</span>],g-&gt;dim,time,
         g-&gt;coords, g-&gt;data);

   coord_count = <span class="Constant">0</span>;

   <span class="Statement">for</span>(j=<span class="Constant">0</span>;j&lt;g-&gt;dim;j++) {
      g-&gt;bbox[j*<span class="Constant">2</span>] = g-&gt;coords[coord_count];
      g-&gt;bbox[<span class="Constant">2</span>*j+<span class="Constant">1</span>] = g-&gt;coords[coord_count+g-&gt;shape[j]-<span class="Constant">1</span>];
      coord_count += g-&gt;shape[j];
   }

   <span class="Statement">switch</span> (g-&gt;dim) {
      <span class="Statement">case</span> <span class="Constant">3</span>:
         g-&gt;x = g-&gt;coords;
         g-&gt;y = &amp;(g-&gt;coords[g-&gt;shape[<span class="Constant">0</span>]]);
         g-&gt;z = &amp;(g-&gt;coords[g-&gt;shape[<span class="Constant">0</span>]+g-&gt;shape[<span class="Constant">1</span>]]);
         g-&gt;dx = g-&gt;x[<span class="Constant">1</span>] - g-&gt;x[<span class="Constant">0</span>];
         g-&gt;dy = g-&gt;y[<span class="Constant">1</span>] - g-&gt;y[<span class="Constant">0</span>];
         g-&gt;dz = g-&gt;z[<span class="Constant">1</span>] - g-&gt;z[<span class="Constant">0</span>];
         g-&gt;Nx = g-&gt;shape[<span class="Constant">0</span>];
         g-&gt;Ny = g-&gt;shape[<span class="Constant">1</span>];
         g-&gt;Nz = g-&gt;shape[<span class="Constant">2</span>];
         g-&gt;xmin = g-&gt;bbox[<span class="Constant">0</span>];
         g-&gt;xmax = g-&gt;bbox[<span class="Constant">1</span>];
         g-&gt;ymin = g-&gt;bbox[<span class="Constant">2</span>];
         g-&gt;ymax = g-&gt;bbox[<span class="Constant">3</span>];
         g-&gt;zmin = g-&gt;bbox[<span class="Constant">4</span>];
         g-&gt;zmax = g-&gt;bbox[<span class="Constant">5</span>];

         <span class="Statement">break</span>;
      <span class="Statement">case</span> <span class="Constant">2</span>:
         g-&gt;x = g-&gt;coords;
         g-&gt;y = &amp;(g-&gt;coords[g-&gt;shape[<span class="Constant">0</span>]]);
         g-&gt;dx = g-&gt;x[<span class="Constant">1</span>] - g-&gt;x[<span class="Constant">0</span>];
         g-&gt;dy = g-&gt;y[<span class="Constant">1</span>] - g-&gt;y[<span class="Constant">0</span>];
         g-&gt;Nx = g-&gt;shape[<span class="Constant">0</span>];
         g-&gt;Ny = g-&gt;shape[<span class="Constant">1</span>];
         g-&gt;xmin = g-&gt;bbox[<span class="Constant">0</span>];
         g-&gt;xmax = g-&gt;bbox[<span class="Constant">1</span>];
         g-&gt;ymin = g-&gt;bbox[<span class="Constant">2</span>];
         g-&gt;ymax = g-&gt;bbox[<span class="Constant">3</span>];
         <span class="Statement">break</span>;
      <span class="Statement">case</span> <span class="Constant">1</span>:
         g-&gt;x = g-&gt;coords;
         g-&gt;dx = g-&gt;x[<span class="Constant">1</span>] - g-&gt;x[<span class="Constant">0</span>];
         g-&gt;Nx = g-&gt;shape[<span class="Constant">0</span>];
         g-&gt;xmin = g-&gt;bbox[<span class="Constant">0</span>];
         g-&gt;xmax = g-&gt;bbox[<span class="Constant">1</span>];
         <span class="Statement">break</span>;
      <span class="Statement">default</span>:
         printf(<span class="Constant">&quot;sdf_read: **WARNING**, DIM not supported</span><span class="Special">\n</span><span class="Constant">&quot;</span>);
         <span class="Statement">break</span>;
   }

   <span class="Statement">return</span> rc;
}
</pre>

<p>

</p>

		      <div style="clear: both;"></div>
	         </div>
		      <hr />
	         <div class ="date">last update: Wed Aug 19, 2015</div>
	    <div class="footer">
           <p><a href="Home.html">Home</a>|<a href="Research.html">Research</a>|<a href="Contact.html">Contact</a>|<a href="Links.html">Links</a>|<a href="Misc.html">Misc</a>|<a href="sg">Template</a></p>

      </div>  
	    <div style="clear: both;">&nbsp;</div>
        </div> <!-- end content -->
	<!-- in class postandside -->

                 <!--in class postandside-->   
         <!--this line is for compatibility issues --><div style="clear: both;">&#160;</div> <!--Displacement --> 
     </div> <!--End of post and side -->

     <!-- in class page2 -->
     <div style="clear: both;">&nbsp;</div>
  </div> <!--End of Page2 -->
     <div style="clear: both;">&nbsp;</div>

</div> <!-- End of page -->
<!--this is end of the file -->
<!-- ~~~ This content is generated using sg web template ~~-->
<!-- ~~~ For more information visit: http://laplace.physics.ubc.ca/People/arman/sg ~~ -->
</body>
</html>
