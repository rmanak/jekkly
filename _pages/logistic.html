<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Arman Akbarian's Homepage" />
<meta name="keywords" content="Arman Akbarian homepage web webpage academic website site UBC
numerical relativity group" />
<meta name="author" content="Arman Akbarian" />
<link rel="stylesheet" type="text/css" href="pagestyle.css" />
<title>Arman Akbarian's Homepage</title>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>
<div class="page">
  <div class="page2">
     <div style="width:100%;height:1px;font-family: Tahoma; font-size: 1pt;"></div>
     <div  class ="header">
		
	     <div class="title">

			Arman Akbarian
			<div class="subtitle">UNIVERSITY OF BRITISH COLUMBIA <br /> PHYSICS &amp; ASTRONOMY DEPT. </div>
	</div> <!-- End of title -->
		<div class="sidebar">
         	<div class="sider">
               <p><a href="Home.html">Home <img src="img/home.svg" width="11px" /></a>
<a href="Research.html">Research <img src="img/beaker.svg" width="11px" /></a>
<a href="Publications.html">Publications <img src="img/pencil.svg" width="11px" /></a>
<a target="_blank" href="http://laplace.phas.ubc.ca/">Group Page <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/people.svg" width="11px" /></a>
<a href="Contact.html">Contact <img src="img/envelope-closed.svg" width="11px" /></a>
<a href="CV.html">CV <img src="img/person.svg" width="11px" /></a></p>

<hr />

<p><a href="Links.html">Links <img src="img/link.svg" width="11px" /></a>
<a href="Learn-By-Examples.html">Programming <img src="img/code.svg" width="11px"/></a>
<a target="_blank" href="FD_doc">FD Toolkit <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/graph.svg" width="11px" /></a>
<a target="_blank" href="sg">Web Template <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/globe.svg" width="11px" /></a>
<a href="http://rmanak.github.io/notes">Miscellany <img src="img/layers.svg" width="11px" /></a></p>

             </div>
         </div> <!--End of Sidebar -->


     </div> <!-- end header -->
	
     <!--This line is for future use -->   <div style="text-align:center; padding-top:10px; padding-bottom:10px;"></div>
	      
     <!--This line is for compatibility issues --> <div style="width:100%;height:5px;font-family: Tahoma; font-size: 1pt;"></div>
     <!--in class page2 -->
     <div class="postandside">
		        <div class="content">
            <div class="post">
              <h3>Maple/Octave Implementation of Classification Using Logistic Regression:</h3>

<p><div style="margin-left:auto; margin-right:auto; padding:3px; text-align:justify; border:solid #BBBBBB 1px; height:auto; width: auto; max-width:500px;"><img style="display:block; height:auto; width:auto; max-width:470px; margin-left:auto; margin-right:auto;" src="./files/logistic.png" alt="" border="0" /></div></p>

<h3>Main Routine:</h3>

<p><style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #000000; background-color: #ffffff; }
.Comment { color: #8080ff; font-weight: bold; }
.Constant { color: #ff6060; }
.Special { color: #ff40ff; }
.Identifier { color: #00ffff; }
.Statement { color: #aaaa00; }
-->
</style>

<script type='text/javascript'>
<!--

-->
</script>
<pre id='vimCodeElement'>
<span class="Comment">% Loading training set:</span>
data = load(<span class="Constant">'datalogisticregression.txt'</span>)<span class="Special">;</span>
X = data(:, <span class="Identifier">[</span><span class="Constant">1</span>, <span class="Constant">2</span><span class="Identifier">]</span>)<span class="Special">;</span> y = data(:, <span class="Constant">3</span>)<span class="Special">;</span>
<span class="Comment">% Adding non-linear features:</span>
rf=<span class="Constant">100</span><span class="Special">;</span>
X = <span class="Identifier">[</span>X , X<span class="Statement">.^</span><span class="Constant">2</span><span class="Statement">/</span>rf, X(:,<span class="Constant">1</span>)<span class="Statement">.*</span>X(:,<span class="Constant">2</span>)<span class="Statement">/</span>rf<span class="Identifier">]</span><span class="Special">;</span>

<span class="Comment">%First visualizing the data:</span>
pos = find(y<span class="Statement">==</span><span class="Constant">1</span>)<span class="Special">;</span> neg = find(y<span class="Statement">==</span><span class="Constant">0</span>)<span class="Special">;</span>
plot(X(pos,<span class="Constant">1</span>),X(pos,<span class="Constant">2</span>),<span class="Constant">'g+'</span>,X(neg,<span class="Constant">1</span>),X(neg,<span class="Constant">2</span>),<span class="Constant">'bo'</span>,<span class="Constant">'MarkerSize'</span>,<span class="Constant">8</span>)<span class="Special">;</span>
hold on

<span class="Identifier">[</span>m, n<span class="Identifier">]</span> = <span class="Statement">size</span>(X)<span class="Special">;</span>

<span class="Comment">% Add intercept term to data</span>
X = <span class="Identifier">[</span><span class="Statement">ones</span>(m, <span class="Constant">1</span>) X<span class="Identifier">]</span><span class="Special">;</span>

init_theta = <span class="Statement">zeros</span>(n <span class="Statement">+</span> <span class="Constant">1</span>, <span class="Constant">1</span>)<span class="Special">;</span>

<span class="Identifier">[</span>cost, grad<span class="Identifier">]</span> = costfunction(init_theta, X, y)<span class="Special">;</span>

<span class="Comment">%Optimizing the cost function using Matlab's built-in fminunc</span>
options = optimset(<span class="Constant">'GradObj'</span>, <span class="Constant">'on'</span>, <span class="Constant">'MaxIter'</span>, <span class="Constant">1000</span>)<span class="Special">;</span>
<span class="Identifier">[</span>theta, cost<span class="Identifier">]</span> = <span class="Comment">...</span>
   fminunc(@(t)(costfunction(t, X, y)), init_theta, options)<span class="Special">;</span>

fprintf(<span class="Constant">'After optimization cost is: %f\n'</span>,cost)<span class="Special">;</span>
fprintf(<span class="Constant">'Parameter Vector is:\n'</span>)<span class="Special">;</span>
theta
prob = sigmoid(<span class="Identifier">[</span><span class="Constant">1</span> <span class="Constant">50</span> <span class="Constant">80</span> <span class="Constant">50</span><span class="Statement">^</span><span class="Constant">2</span><span class="Statement">/</span>rf <span class="Constant">80</span><span class="Statement">^</span><span class="Constant">2</span><span class="Statement">/</span>rf <span class="Constant">50</span><span class="Statement">*</span><span class="Constant">80</span><span class="Statement">/</span>rf<span class="Identifier">]</span> <span class="Statement">*</span> theta)<span class="Special">;</span>
fprintf(<span class="Constant">'For feature 45 and 80, probability is %f\n'</span>, prob)<span class="Special">;</span>

<span class="Comment">% Compute accuracy of the results:</span>
prediction = sigmoid(X<span class="Statement">*</span>theta) <span class="Statement">&gt;</span> <span class="Constant">0.5</span><span class="Special">;</span>

fprintf(<span class="Constant">'Training Accuracy: %f\n'</span>, <span class="Statement">mean</span>(double(prediction <span class="Statement">==</span> y)) <span class="Statement">*</span> <span class="Constant">100</span>)<span class="Special">;</span>

<span class="Comment">% plotting the decision boundary:</span>
X1 = linspace(<span class="Constant">30</span>,<span class="Constant">100</span>,<span class="Constant">100</span>)<span class="Statement">'</span><span class="Special">;</span>
X2 = linspace(<span class="Constant">30</span>,<span class="Constant">100</span>,<span class="Constant">100</span>)<span class="Special">;</span>

z = <span class="Statement">zeros</span>(<span class="Constant">100</span>,<span class="Constant">100</span>)<span class="Special">;</span>

z = sigmoid(<span class="Constant">1.0</span><span class="Statement">*</span>theta(<span class="Constant">1</span>) <span class="Statement">+</span> X1<span class="Statement">*</span><span class="Statement">ones</span>(<span class="Constant">1</span>,<span class="Constant">100</span>)<span class="Statement">*</span>theta(<span class="Constant">2</span>) <span class="Statement">+</span> <span class="Statement">ones</span>(<span class="Constant">100</span>,<span class="Constant">1</span>)<span class="Statement">*</span>X2<span class="Statement">*</span>theta(<span class="Constant">3</span>) <span class="Statement">+</span> <span class="Comment">...</span>
(X1<span class="Statement">*</span><span class="Statement">ones</span>(<span class="Constant">1</span>,<span class="Constant">100</span>))<span class="Statement">.^</span><span class="Constant">2</span><span class="Statement">/</span>rf<span class="Statement">*</span>theta(<span class="Constant">4</span>) <span class="Statement">+</span> (<span class="Statement">ones</span>(<span class="Constant">100</span>,<span class="Constant">1</span>)<span class="Statement">*</span>X2)<span class="Statement">.^</span><span class="Constant">2</span><span class="Statement">/</span>rf<span class="Statement">*</span>theta(<span class="Constant">5</span>) <span class="Statement">+</span> <span class="Comment">...</span>
theta(<span class="Constant">6</span>)<span class="Statement">*</span>X1<span class="Statement">*</span>X2<span class="Statement">/</span>rf)<span class="Special">;</span>

mesh(X1<span class="Statement">'</span>,X2,z)<span class="Special">;</span>
colormap cool<span class="Special">;</span>
colorbar<span class="Special">;</span>

print <span class="Statement">-</span>dpng regplot.png

hold off

</pre>
</p>

<h3>Sigmoid Function:</h3>

<p><style>
.Constant { color: #ff6060; }
.Special { color: #ff40ff; }
.Identifier { color: #00ffff; }
.Statement { color: #bbbb00; }
</style>

<pre id='vimCodeElement'>
<span class="Identifier">function</span> g = sigmoid(z)
g = <span class="Constant">1</span><span class="Statement">./</span>(<span class="Constant">1</span><span class="Statement">+</span><span class="Statement">exp</span>(<span class="Statement">-</span>z))<span class="Special">;</span>
<span class="Statement">end</span>
</pre>
</p>

<h3>Cost Function:</h3>

<p><style type="text/css">
.Comment { color: #8080ff; font-weight: bold; }
.Constant { color: #ff6060; }
.Special { color: #ff40ff; }
.Identifier { color: #00ffff; }
.Statement { color: #bbbb00; }
</style>
<pre>
<span class="Identifier">function</span> <span class="Identifier">[</span>J, grad<span class="Identifier">]</span> = costfunction(theta, X, y)
m = length(y)<span class="Special">;</span> <span class="Comment">% number of parameters in the model</span>

J = <span class="Constant">0</span><span class="Special">;</span>
grad = <span class="Statement">zeros</span>(<span class="Statement">size</span>(theta))<span class="Special">;</span>

J = (<span class="Statement">-</span>y<span class="Statement">'</span><span class="Statement">*</span><span class="Statement">log</span>(sigmoid(X<span class="Statement">*</span>theta)) <span class="Statement">-</span> (<span class="Constant">1</span><span class="Statement">-</span>y<span class="Statement">'</span>)<span class="Statement">*</span><span class="Statement">log</span>(<span class="Constant">1</span><span class="Statement">-</span>sigmoid(X<span class="Statement">*</span>theta)))<span class="Statement">/</span>m<span class="Special">;</span>
grad = (X<span class="Statement">'</span><span class="Statement">*</span>(sigmoid(X<span class="Statement">*</span>theta)<span class="Statement">-</span>y))<span class="Statement">/</span>m<span class="Special">;</span>

<span class="Statement">end</span>
</pre>
</p>

<h3>Data File:</h3>

<p><a href="files/datalogisticregression.txt">[datalogisticregression.txt]</a>


</p>

		      <div style="clear: both;"></div>
	         </div>
		      <hr />
	         <div class ="date">last update: Mon Aug 24, 2015</div>
	    <div class="footer">
           <p><a href="Home.html">Home</a>|<a href="Research.html">Research</a>|<a href="Contact.html">Contact</a>|<a href="Links.html">Links</a>|<a href="Misc.html">Misc</a>|<a href="sg">Template</a></p>

      </div>  
	    <div style="clear: both;">&nbsp;</div>
        </div> <!-- end content -->
	<!-- in class postandside -->

                 <!--in class postandside-->   
         <!--this line is for compatibility issues --><div style="clear: both;">&#160;</div> <!--Displacement --> 
     </div> <!--End of post and side -->

     <!-- in class page2 -->
     <div style="clear: both;">&nbsp;</div>
  </div> <!--End of Page2 -->
     <div style="clear: both;">&nbsp;</div>

</div> <!-- End of page -->
<!--this is end of the file -->
<!-- ~~~ This content is generated using sg web template ~~-->
<!-- ~~~ For more information visit: http://laplace.physics.ubc.ca/People/arman/sg ~~ -->
</body>
</html>
