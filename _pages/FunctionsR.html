<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Arman Akbarian's Homepage" />
<meta name="keywords" content="Arman Akbarian homepage web webpage academic website site UBC
numerical relativity group" />
<meta name="author" content="Arman Akbarian" />
<link rel="stylesheet" type="text/css" href="pagestyle.css" />
<title>Arman Akbarian's Homepage</title>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>
<div class="page">
  <div class="page2">
     <div style="width:100%;height:1px;font-family: Tahoma; font-size: 1pt;"></div>
     <div  class ="header">
		
	     <div class="title">

			Arman Akbarian
			<div class="subtitle">UNIVERSITY OF BRITISH COLUMBIA <br /> PHYSICS &amp; ASTRONOMY DEPT. </div>
	</div> <!-- End of title -->
		<div class="sidebar">
         	<div class="sider">
               <p><a href="Home.html">Home <img src="img/home.svg" width="11px" /></a>
<a href="Research.html">Research <img src="img/beaker.svg" width="11px" /></a>
<a href="Publications.html">Publications <img src="img/pencil.svg" width="11px" /></a>
<a target="_blank" href="http://laplace.phas.ubc.ca/">Group Page <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/people.svg" width="11px" /></a>
<a href="Contact.html">Contact <img src="img/envelope-closed.svg" width="11px" /></a>
<a href="CV.html">CV <img src="img/person.svg" width="11px" /></a></p>

<hr />

<p><a href="Links.html">Links <img src="img/link.svg" width="11px" /></a>
<a href="Learn-By-Examples.html">Programming <img src="img/code.svg" width="11px"/></a>
<a target="_blank" href="FD_doc">FD Toolkit <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/graph.svg" width="11px" /></a>
<a target="_blank" href="sg">Web Template <img style="margin-left:1px;" src="img/external-link.svg" alt="" align="bottom" /> <img src="img/globe.svg" width="11px" /></a>
<a href="http://rmanak.github.io/notes">Miscellany <img src="img/layers.svg" width="11px" /></a></p>

             </div>
         </div> <!--End of Sidebar -->


     </div> <!-- end header -->
	
     <!--This line is for future use -->   <div style="text-align:center; padding-top:10px; padding-bottom:10px;"></div>
	      
     <!--This line is for compatibility issues --> <div style="width:100%;height:5px;font-family: Tahoma; font-size: 1pt;"></div>
     <!--in class page2 -->
     <div class="postandside">
		        <div class="content">
            <div class="post">
              <p><style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #000000; background-color: #ffffff; }
* { font-size: 1em; }
.Comment { color: #8080ff; font-weight: bold; }
.Constant { color: #ff6060; }
.Special { color: #ff40ff; }
.Statement { color: #aaaa00; }
.Type { color: #00ff00; }
-->
</style>

<script type='text/javascript'>
<!--

-->
</script>
<pre id='vimCodeElement'>
<span class="Comment">#-----------------------------------</span>
<span class="Comment"># AAK  Mon 10 Aug 2014 00:39:54 PDT</span>
<span class="Comment"># Functions in R</span>
<span class="Comment">#-----------------------------------</span>

<span class="Comment"># Functions returns the last calculation:</span>
myadd <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">,</span>y<span class="Special">)</span> <span class="Special">{</span>
    x<span class="Statement">+</span>y
<span class="Special">}</span>

<span class="Comment"># Vector as an input:</span>
aboveval <span class="Statement">&lt;-</span><span class="Type">function</span><span class="Special">(</span>x<span class="Special">,</span>threshold<span class="Special">){</span>
<span class="Comment"># Logical subsetting</span>
    use <span class="Statement">&lt;-</span> x <span class="Statement">&gt;</span> threshold
        x<span class="Special">[</span>use<span class="Special">]</span>
<span class="Special">}</span>

<span class="Comment"># Function with default value: (step function, default at 0)</span>
step <span class="Statement">&lt;-</span><span class="Type">function</span><span class="Special">(</span>x<span class="Special">,</span>threshold <span class="Statement">=</span> <span class="Constant">0</span><span class="Special">){</span>
<span class="Comment"># Logical conversion</span>
    as.integer<span class="Special">(</span> x <span class="Statement">&gt;</span> threshold<span class="Special">)</span>
<span class="Special">}</span>

<span class="Comment"># Function with data frame as input and vector as output</span>
RCTM <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">,</span> removeNA <span class="Statement">=</span> <span class="Constant">TRUE</span><span class="Special">)</span> <span class="Special">{</span>
  nc <span class="Statement">&lt;-</span> ncol<span class="Special">(</span>x<span class="Special">)</span>
  <span class="Comment">#initializing an empty vector:</span>
  means <span class="Statement">&lt;-</span> <span class="Type">numeric</span><span class="Special">(</span>nc<span class="Special">)</span>
  <span class="Statement">for</span><span class="Special">(</span>i <span class="Statement">in</span> <span class="Constant">1</span><span class="Special">:</span>nc<span class="Special">)</span> <span class="Special">{</span>
    means<span class="Special">[</span>i<span class="Special">]</span> <span class="Statement">&lt;-</span> mean<span class="Special">(</span>x<span class="Special">[</span><span class="Special">,</span>i<span class="Special">]</span><span class="Special">,</span> na.rm <span class="Statement">=</span> removeNA<span class="Special">)</span>
  <span class="Special">}</span>
  <span class="Comment">#returing a vector</span>
  means
<span class="Special">}</span>

<span class="Comment"># ... argument indicates variables that will be passed in to another function:</span>

myplot <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">,</span> y<span class="Special">,</span> type<span class="Statement">=</span><span class="Constant">&quot;l&quot;</span><span class="Special">,</span> ...<span class="Special">){</span>
  plot<span class="Special">(</span>x<span class="Special">,</span> y<span class="Special">,</span> type<span class="Statement">=</span>type<span class="Special">,</span>...<span class="Special">)</span>
<span class="Special">}</span>

<span class="Comment"># Defining a function in a function, and returning it</span>

make.pow <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>n<span class="Special">)</span> <span class="Special">{</span>
 pow <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">)</span> <span class="Special">{</span>
    x<span class="Statement">^</span>n
  <span class="Special">}</span>
 pow
<span class="Special">}</span>

<span class="Comment"># Now you can ``create`` functions using this:</span>

cube <span class="Statement">&lt;-</span> make.pow<span class="Special">(</span><span class="Constant">3</span><span class="Special">)</span>
square <span class="Statement">&lt;-</span> make.pow<span class="Special">(</span><span class="Constant">2</span><span class="Special">)</span>

cat<span class="Special">(</span><span class="Constant">'cube(3) = '</span><span class="Special">,</span>cube<span class="Special">(</span><span class="Constant">3</span><span class="Special">)</span><span class="Special">,</span> <span class="Constant">'</span><span class="Special">\n</span><span class="Constant">'</span><span class="Special">)</span>
cat<span class="Special">(</span><span class="Constant">'square(3) = '</span><span class="Special">,</span> square<span class="Special">(</span><span class="Constant">3</span><span class="Special">)</span><span class="Special">,</span> <span class="Constant">'</span><span class="Special">\n</span><span class="Constant">'</span><span class="Special">)</span>

<span class="Comment"># R uses &quot;Lexical scoping&quot; i.e: It looks up the value of</span>
<span class="Comment"># the free variables from the enviroument that the function</span>
<span class="Comment"># is defined, rather than where it is called (Dynamical scoping)</span>
<span class="Comment"># In the following even if z = 4 will be used when f is invoked </span>
<span class="Comment"># even if there is another z defined before the call. </span>
f <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">)</span> <span class="Special">{</span>
   g <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>y<span class="Special">)</span> <span class="Special">{</span>
      y <span class="Statement">+</span> z
   <span class="Special">}</span>
   z <span class="Statement">&lt;-</span> <span class="Constant">4</span>
   x <span class="Statement">+</span> g<span class="Special">(</span>x<span class="Special">)</span>
<span class="Special">}</span>

<span class="Comment">#-----------------------------------------</span>
<span class="Comment"># Scoping assignment: &lt;&lt;- </span>
<span class="Comment"># Assigns value at the parent enviroument</span>
<span class="Comment">#-----------------------------------------</span>

a <span class="Statement">&lt;-</span> <span class="Constant">3</span>

e <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">)</span> <span class="Special">{</span>
 <span class="Comment">#Will not affect a = 3 above</span>
  a <span class="Statement">&lt;-</span> x
<span class="Special">}</span>

e<span class="Special">(</span><span class="Constant">4</span><span class="Special">)</span>
message<span class="Special">(</span><span class="Constant">&quot;a = &quot;</span><span class="Special">,</span>a<span class="Special">)</span>

t <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">)</span> <span class="Special">{</span>
 <span class="Comment"># Assigning a value at the parent enviroument</span>
 <span class="Comment"># Will affect the a=3</span>
 a <span class="Statement">&lt;&lt;-</span> x
<span class="Special">}</span>

<span class="Comment"># Now calling t function will change the value of the</span>
<span class="Comment"># a in the parent envirounment</span>
t<span class="Special">(</span><span class="Constant">4</span><span class="Special">)</span>
message<span class="Special">(</span><span class="Constant">&quot;a now changed to ==&gt; &quot;</span><span class="Special">,</span>a<span class="Special">)</span>

<span class="Comment"># More complicated example:</span>

CreateCache <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Statement">=</span><span class="Type">numeric</span><span class="Special">())</span> <span class="Special">{</span>
   cache <span class="Statement">&lt;-</span> <span class="Constant">0</span>
   increment <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">()</span> cache <span class="Statement">&lt;&lt;-</span> cache <span class="Statement">+</span> <span class="Constant">1</span>
<span class="Special">}</span>

AA <span class="Statement">&lt;-</span> CreateCache<span class="Special">()</span>
BB <span class="Statement">&lt;-</span> CreateCache<span class="Special">()</span>

<span class="Comment"># Now each call of AA function will increment cache in</span>
<span class="Comment"># its internal enviroument by one</span>
<span class="Comment"># Note that the cache is in the enviroument of CreateCache (AA)</span>
<span class="Comment"># not the global enviroument, and creating another copy of</span>
<span class="Comment"># the function in BB will create another cache</span>


AA<span class="Special">()</span> <span class="Comment"># cache becomes 1</span>
BB<span class="Special">()</span> <span class="Comment"># cache becomes 1 (has nothing to do with AA)</span>
AA<span class="Special">()</span> <span class="Comment"># cache becomes 2 (wont affect BB's cache)</span>
AA<span class="Special">()</span> <span class="Comment"># cache becomes 3</span>
resultcachinAA <span class="Statement">&lt;-</span> AA<span class="Special">()</span> <span class="Comment"># Cache becomes 4 and returns to result</span>
resultcachinBB <span class="Statement">&lt;-</span> BB<span class="Special">()</span> <span class="Comment"># Cache becomes 2 and returns to result</span>
message<span class="Special">(</span><span class="Constant">&quot;Now cache in AA is &quot;</span><span class="Special">,</span> resultcachinAA<span class="Special">)</span>
message<span class="Special">(</span><span class="Constant">&quot;Now cache in BB is &quot;</span><span class="Special">,</span> resultcachinBB<span class="Special">)</span>

<span class="Comment"># Using this, the following allows caching the</span>
<span class="Comment"># inverse of the matrix and returning it from</span>
<span class="Comment"># cached value rather than computing it again</span>

<span class="Comment">#----------------------------------------------------</span>
<span class="Comment"># Creates a special matrix type from a given matrix x</span>
<span class="Comment"># with handle functions get, set, getinv, setinv that</span>
<span class="Comment"># encapsulates the access to the underlying matrix and</span>
<span class="Comment"># the cached inverse matrix.</span>
<span class="Comment">#----------------------------------------------------</span>
makeCacheMatrix <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x <span class="Statement">=</span> <span class="Type">matrix</span><span class="Special">())</span> <span class="Special">{</span>
    <span class="Comment"># When called, empty cache containing inverse:</span>
    invm <span class="Statement">&lt;-</span> <span class="Constant">NULL</span>
    <span class="Comment"># Sets the matrix to the given value and cleans cache:</span>
    set <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>y<span class="Special">)</span> <span class="Special">{</span>
        x <span class="Statement">&lt;&lt;-</span> y
        invm <span class="Statement">&lt;&lt;-</span> <span class="Constant">NULL</span>
    <span class="Special">}</span>
    <span class="Comment"># Returns the Matrix:</span>
    get <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">()</span> x
    <span class="Comment"># Sets the cached invm value to the given value</span>
    setinv <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>inverse<span class="Special">)</span> invm <span class="Statement">&lt;&lt;-</span> inverse
    <span class="Comment"># Returns the cached value:</span>
    getinv <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">()</span> invm
    <span class="Comment"># List of the handle functions:</span>
    <span class="Type">list</span><span class="Special">(</span>set <span class="Statement">=</span> set<span class="Special">,</span> get<span class="Statement">=</span>get<span class="Special">,</span> setinv<span class="Statement">=</span>setinv<span class="Special">,</span> getinv<span class="Statement">=</span>getinv<span class="Special">)</span>
<span class="Special">}</span>


<span class="Comment">#------------------------------------------------------------</span>
<span class="Comment"># Returns the inverse (invm) of a special &quot;matrix&quot; type (x)</span>
<span class="Comment"># created by makeCacheMatrix either from the cached value </span>
<span class="Comment"># or from a computed value if the cach is empty (invm = NULL) </span>
<span class="Comment">#-------------------------------------------------------------</span>

cacheSolve <span class="Statement">&lt;-</span> <span class="Type">function</span><span class="Special">(</span>x<span class="Special">,</span> ...<span class="Special">)</span> <span class="Special">{</span>
        <span class="Comment"># Attempt to get inverse from cached value:</span>
        invm <span class="Statement">&lt;-</span> x<span class="Special">$</span>getinv<span class="Special">()</span>
        <span class="Statement">if</span> <span class="Special">(</span><span class="Statement">!</span>is.null<span class="Special">(</span>invm<span class="Special">))</span> <span class="Special">{</span>
            message<span class="Special">(</span><span class="Constant">&quot;getting cached data&quot;</span><span class="Special">)</span>
            <span class="Statement">return</span><span class="Special">(</span>invm<span class="Special">)</span>
        <span class="Special">}</span>
        <span class="Comment"># If cached value is empty (NULL) compute the inverse:</span>
        mtrx <span class="Statement">&lt;-</span> x<span class="Special">$</span>get<span class="Special">()</span>
        message<span class="Special">(</span><span class="Constant">&quot;Computing inverse, this can take a while...&quot;</span><span class="Special">)</span>
        invm <span class="Statement">&lt;-</span> solve<span class="Special">(</span>mtrx<span class="Special">,</span>...<span class="Special">)</span>
        <span class="Comment"># Set the cache to the current value</span>
        x<span class="Special">$</span>setinv<span class="Special">(</span>invm<span class="Special">)</span>
        invm
<span class="Special">}</span>

<span class="Comment"># First creating 1000x1000 matrix</span>
X <span class="Statement">&lt;-</span> replicate<span class="Special">(</span><span class="Constant">1000</span><span class="Special">,</span>rnorm<span class="Special">(</span><span class="Constant">1000</span><span class="Special">))</span>

<span class="Comment"># Creating the matrix function with internal cache:</span>
mymatrix <span class="Statement">&lt;-</span> makeCacheMatrix<span class="Special">()</span>

<span class="Comment"># Setting the internal value of mymatrix:</span>
mymatrix<span class="Special">$</span>set<span class="Special">(</span>X<span class="Special">)</span>
<span class="Comment"># First call will use solve routine to find the inverse:</span>
cacheSolve<span class="Special">(</span>mymatrix<span class="Special">)</span>
<span class="Comment"># Second and third call will use the cached value:</span>
cacheSolve<span class="Special">(</span>mymatrix<span class="Special">)</span>
cacheSolve<span class="Special">(</span>mymatrix<span class="Special">)</span>
</pre>



</p>

		      <div style="clear: both;"></div>
	         </div>
		      <hr />
	         <div class ="date">last update: Wed Aug 19, 2015</div>
	    <div class="footer">
           <p><a href="Home.html">Home</a>|<a href="Research.html">Research</a>|<a href="Contact.html">Contact</a>|<a href="Links.html">Links</a>|<a href="Misc.html">Misc</a>|<a href="sg">Template</a></p>

      </div>  
	    <div style="clear: both;">&nbsp;</div>
        </div> <!-- end content -->
	<!-- in class postandside -->

                 <!--in class postandside-->   
         <!--this line is for compatibility issues --><div style="clear: both;">&#160;</div> <!--Displacement --> 
     </div> <!--End of post and side -->

     <!-- in class page2 -->
     <div style="clear: both;">&nbsp;</div>
  </div> <!--End of Page2 -->
     <div style="clear: both;">&nbsp;</div>

</div> <!-- End of page -->
<!--this is end of the file -->
<!-- ~~~ This content is generated using sg web template ~~-->
<!-- ~~~ For more information visit: http://laplace.physics.ubc.ca/People/arman/sg ~~ -->
</body>
</html>
